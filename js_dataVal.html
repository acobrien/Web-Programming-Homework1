<html>
<head>
<title>Data Validation Example</title>
<script type="text/javascript">
    // Determines if a value is empty
    function isEmpty(val) {
	    if ((val==null) || (val=="")) {
		    return true
		}
	    return false
    }

    // Determines if a value entered is numeric
	function isANumber(val) {
		var digits = "0123456789.";

		var numDecimals = 0;
		for (i = 0; i < val.length; i++) {
			var c = val.charAt(i)
			if (digits.indexOf(c) == -1) {
				return false;
			}
			if (c == '.') {
				numDecimals++;
				if (numDecimals > 1) {
					return false;
				}
			}
		}

		//alert("val="+val);
        var parsedVal = parseFloat(val);
        if (isNaN(parsedVal)) {
            return false;
        }
        return true;
    }

    // Determines if entry is a string composed of alphabetic characters, not used
    function isWordAlphabetic(word) {
        var alphabet = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
        for (i=0; i<word.length; i++) {
            if(alphabet.indexOf(word.charAt(i)) == -1) {
				return false;
			}
        }
        return true;
    }

	function displayErrorMsg(msg, control) {
		alert(msg);
		control.focus();
		control.select();
	}
    // Displays values that were entered.
	function displayResults() {
		var txtNum = document.getElementById("txtNum");
		var val = txtNum.value;
		if (isEmpty(val)) {
			displayErrorMsg("Must supply a value", txtNum);
			return;
		}
		if (!isANumber(val)) {
			displayErrorMsg("Must be a number", txtNum);
			return;
		}
		var num = parseFloat(val);
		var numSqd = Math.pow(num, 2);
		var msg = "num=" + num.toFixed(2) + ", num^2=" + numSqd.toFixed(2);
        document.getElementById("txaResult").value = msg;
    }

    // Sets focus to control
    function setFocus(ctrl) {
        ctrl.focus();
    }
</script>
</head>

<body onload="setFocus(txtNum)">

<h2>Data Validation Example</h2>
<form name="frmNumForm">
	<p>Enter a number 
        <input id="txtNum" type="text"/></p>

    <input id="btnCalc" type="button" value="Display Results" onclick="displayResults()"/>
	
	<p>Result:</p>
    <p><textarea rows="4" id="txaResult" cols="60"></textarea></p>
</form>

</body>

</html>
